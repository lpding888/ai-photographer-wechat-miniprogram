<!--ç®¡ç†ä¸­å¿ƒé¡µé¢-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="header">
    <text class="title">ğŸ› ï¸ ç³»ç»Ÿç®¡ç†ä¸­å¿ƒ</text>
    <text class="subtitle">AIæ¨¡å‹ Â· æç¤ºè¯ Â· åœºæ™¯ Â· å¥—é¤ Â· ç”¨æˆ· Â· ç»Ÿè®¡</text>
  </view>

  <!-- æ ‡ç­¾é¡µå¯¼èˆª -->
  <view class="tab-bar">
    <view 
      class="tab-item {{currentTab === 0 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="0"
    >
      <text class="tab-icon">ğŸ¤–</text>
      <text class="tab-text">AIæ¨¡å‹</text>
    </view>
    <view 
      class="tab-item {{currentTab === 1 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="1"
    >
      <text class="tab-icon">ğŸ’¡</text>
      <text class="tab-text">æç¤ºè¯</text>
    </view>
    <view
      class="tab-item {{currentTab === 2 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="2"
    >
      <text class="tab-icon">ğŸ¬</text>
      <text class="tab-text">åœºæ™¯</text>
    </view>
    <view
      class="tab-item {{currentTab === 3 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="3"
    >
      <text class="tab-icon">ğŸ’°</text>
      <text class="tab-text">å¥—é¤</text>
    </view>
    <view
      class="tab-item {{currentTab === 4 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="4"
    >
      <text class="tab-icon">ğŸ‘¥</text>
      <text class="tab-text">ç”¨æˆ·</text>
    </view>
    <view
      class="tab-item {{currentTab === 5 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="5"
    >
      <text class="tab-icon">ğŸ“Š</text>
      <text class="tab-text">ç»Ÿè®¡</text>
    </view>
  </view>

  <!-- AIæ¨¡å‹ç®¡ç† -->
  <view class="tab-content" wx:if="{{currentTab === 0}}">
    <view class="section-header">
      <text class="section-title">AIæ¨¡å‹ç®¡ç†</text>
      <button class="add-btn" bindtap="showAddModelDialog">
        <text class="btn-icon">â•</text>
        <text>æ·»åŠ æ¨¡å‹</text>
      </button>
    </view>

    <view class="model-list">
      <view 
        class="model-item {{item.status === 'active' ? 'active' : 'inactive'}}"
        wx:for="{{aiModels}}" 
        wx:key="id"
      >
        <view class="model-info">
          <view class="model-header">
            <text class="model-name">{{item.name}}</text>
            <view class="model-status {{item.status}}">
              {{item.status === 'active' ? 'âœ… å¯ç”¨' : 'âŒ ç¦ç”¨'}}
            </view>
          </view>
          <text class="model-desc">{{item.description}}</text>
          <view class="model-meta">
            <text class="meta-item">ç±»å‹: {{item.type}}</text>
            <text class="meta-item">æƒé‡: {{item.weight}}</text>
            <text class="meta-item">ä¼˜å…ˆçº§: {{item.priority}}</text>
          </view>
        </view>
        <view class="model-actions">
          <button class="action-btn edit" bindtap="editModel" data-model="{{item}}">ç¼–è¾‘</button>
          <button 
            class="action-btn toggle"
            bindtap="toggleModelStatus" 
            data-id="{{item._id}}"
            data-status="{{item.status}}"
          >
            {{item.status === 'active' ? 'ç¦ç”¨' : 'å¯ç”¨'}}
          </button>
          <button class="action-btn delete" bindtap="deleteModel" data-id="{{item._id}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
  </view>

  <!-- æç¤ºè¯ç®¡ç† -->
  <view class="tab-content" wx:if="{{currentTab === 1}}">
    <view class="section-header">
      <text class="section-title">æç¤ºè¯æ¨¡æ¿ç®¡ç†</text>
      <button class="add-btn" bindtap="showAddPromptDialog">
        <text class="btn-icon">â•</text>
        <text>æ·»åŠ æ¨¡æ¿</text>
      </button>
    </view>

    <view class="prompt-list">
      <view class="prompt-item" wx:for="{{promptTemplates}}" wx:key="_id">
        <view class="prompt-info">
          <view class="prompt-header">
            <text class="prompt-name">{{item.name}}</text>
            <view class="prompt-category">{{item.category}}</view>
          </view>
          <text class="prompt-desc">{{item.description}}</text>
          <view class="prompt-template">
            <text class="template-label">æ¨¡æ¿:</text>
            <text class="template-content">{{item.template}}</text>
          </view>
          <view class="prompt-variables" wx:if="{{item.variablesText && item.variablesText.length > 0}}">
            <text class="variables-label">å˜é‡:</text>
            <text class="variables-content">{{item.variablesText}}</text>
          </view>
        </view>
        <view class="prompt-actions">
          <button class="action-btn edit" bindtap="editPrompt" data-prompt="{{item}}">ç¼–è¾‘</button>
          <button class="action-btn delete" bindtap="deletePrompt" data-id="{{item._id}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
  </view>

  <!-- åœºæ™¯ç®¡ç† -->
  <view class="tab-content" wx:if="{{currentTab === 2}}">
    <view class="section-header">
      <text class="section-title">æ‘„å½±åœºæ™¯ç®¡ç†</text>
      <button class="add-btn" bindtap="showAddSceneDialog">
        <text class="btn-icon">â•</text>
        <text>æ·»åŠ åœºæ™¯</text>
      </button>
    </view>

    <view class="scene-list">
      <view 
        class="scene-item {{item.enabled ? 'enabled' : 'disabled'}}"
        wx:for="{{scenes}}" 
        wx:key="id"
      >
        <view class="scene-info">
          <view class="scene-header">
            <text class="scene-name">{{item.name}}</text>
            <view class="scene-status {{item.enabled ? 'enabled' : 'disabled'}}">
              {{item.enabled ? 'âœ… å¯ç”¨' : 'âŒ ç¦ç”¨'}}
            </view>
          </view>
          <text class="scene-desc">{{item.description}}</text>
          <view class="scene-meta">
            <text class="meta-item">åˆ†ç±»: {{item.category}}</text>
            <text class="meta-item">æ ‡ç­¾: {{item.tagsDisplay}}</text>
          </view>
        </view>
        <view class="scene-actions">
          <button class="action-btn edit" bindtap="editScene" data-scene="{{item}}">ç¼–è¾‘</button>
          <button 
            class="action-btn toggle"
            bindtap="toggleSceneStatus" 
            data-id="{{item.id}}"
            data-enabled="{{item.enabled}}"
          >
            {{item.enabled ? 'ç¦ç”¨' : 'å¯ç”¨'}}
          </button>
          <button class="action-btn delete" bindtap="deleteScene" data-id="{{item.id}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
  </view>

  <!-- å¥—é¤ç®¡ç† -->
  <view class="tab-content" wx:if="{{currentTab === 3}}">
    <view class="section-header">
      <text class="section-title">å……å€¼å¥—é¤ç®¡ç†</text>
      <button class="add-btn" bindtap="showAddPackageDialog">
        <text class="btn-icon">â•</text>
        <text>æ·»åŠ å¥—é¤</text>
      </button>
    </view>

    <view class="package-list">
      <view
        class="package-item {{item.is_active ? 'active' : 'inactive'}}"
        wx:for="{{packages}}"
        wx:key="_id"
      >
        <view class="package-info">
          <view class="package-header">
            <text class="package-name">{{item.name}}</text>
            <view class="package-status {{item.is_active ? 'active' : 'inactive'}}">
              {{item.is_active ? 'âœ… å¯ç”¨' : 'âŒ ç¦ç”¨'}}
            </view>
            <view class="package-popular" wx:if="{{item.is_popular}}">ğŸ”¥ çƒ­é—¨</view>
          </view>
          <text class="package-desc">{{item.description}}</text>
          <view class="package-details">
            <view class="detail-row">
              <text class="detail-label">ç§¯åˆ†æ•°é‡:</text>
              <text class="detail-value">{{item.credits}} å¼ </text>
            </view>
            <view class="detail-row">
              <text class="detail-label">å”®ä»·:</text>
              <text class="detail-value">Â¥{{item.price}}</text>
            </view>
            <view class="detail-row" wx:if="{{item.original_price && item.original_price > item.price}}">
              <text class="detail-label">åŸä»·:</text>
              <text class="detail-value original-price">Â¥{{item.original_price}}</text>
            </view>
            <view class="detail-row" wx:if="{{item.discount}}">
              <text class="detail-label">ä¼˜æƒ æ ‡ç­¾:</text>
              <text class="detail-value discount">{{item.discount}}</text>
            </view>
            <view class="detail-row">
              <text class="detail-label">æ’åº:</text>
              <text class="detail-value">{{item.sort_order || 1}}</text>
            </view>
          </view>
        </view>
        <view class="package-actions">
          <button class="action-btn edit" bindtap="editPackage" data-package="{{item}}">ç¼–è¾‘</button>
          <button
            class="action-btn toggle"
            bindtap="togglePackageStatus"
            data-id="{{item._id || item.id}}"
            data-status="{{item.is_active}}"
          >
            {{item.is_active ? 'ç¦ç”¨' : 'å¯ç”¨'}}
          </button>
          <button class="action-btn delete" bindtap="deletePackage" data-id="{{item._id || item.id}}">åˆ é™¤</button>
        </view>
      </view>
    </view>
  </view>

  <!-- ç”¨æˆ·ç®¡ç† -->
  <view class="tab-content" wx:if="{{currentTab === 4}}">
    <view class="section-header">
      <text class="section-title">ç”¨æˆ·ç®¡ç†</text>
      <view class="filter-controls">
        <input
          class="search-input"
          placeholder="æœç´¢ç”¨æˆ·æ˜µç§°æˆ–ID"
          value="{{userFilter.keyword}}"
          bindinput="onUserSearch"
        />
        <view class="filter-buttons">
          <button
            class="filter-btn {{userFilter.status === 'all' ? 'active' : ''}}"
            bindtap="onUserFilterChange"
            data-filter="status"
            data-value="all"
          >å…¨éƒ¨</button>
          <button
            class="filter-btn {{userFilter.status === 'active' ? 'active' : ''}}"
            bindtap="onUserFilterChange"
            data-filter="status"
            data-value="active"
          >æ´»è·ƒ</button>
          <button
            class="filter-btn {{userFilter.status === 'inactive' ? 'active' : ''}}"
            bindtap="onUserFilterChange"
            data-filter="status"
            data-value="inactive"
          >ç¦ç”¨</button>
        </view>
      </view>
    </view>

    <view class="user-list">
      <view class="user-item" wx:for="{{users}}" wx:key="_id">
        <view class="user-avatar">
          <image
            class="avatar-img"
            src="{{item.avatar_url || '/images/default-avatar.png'}}"
            mode="aspectFill"
          />
        </view>
        <view class="user-info">
          <view class="user-header">
            <text class="user-name">{{item.nickname || 'æœªè®¾ç½®æ˜µç§°'}}</text>
            <view class="user-status {{item.status || 'active'}}">
              {{(item.status || 'active') === 'active' ? 'âœ… æ­£å¸¸' : 'âŒ ç¦ç”¨'}}
            </view>
          </view>
          <text class="user-id">ID: {{item._id}}</text>
          <view class="user-meta">
            <text class="meta-item">ç§¯åˆ†: {{item.credits || 0}}</text>
            <text class="meta-item">ä½œå“: {{item.work_count || 0}}</text>
            <text class="meta-item">æ³¨å†Œ: {{item.created_at || 'æœªçŸ¥'}}</text>
          </view>
        </view>
        <view class="user-actions">
          <button
            class="action-btn toggle"
            bindtap="toggleUserStatus"
            data-user-id="{{item._id}}"
            data-current-status="{{item.status || 'active'}}"
          >
            {{(item.status || 'active') === 'active' ? 'ç¦ç”¨' : 'å¯ç”¨'}}
          </button>
        </view>
      </view>
    </view>
  </view>

  <!-- æ•°æ®ç»Ÿè®¡ -->
  <view class="tab-content" wx:if="{{currentTab === 5}}">
    <view class="section-header">
      <text class="section-title">æ•°æ®ç»Ÿè®¡</text>
      <view class="export-controls">
        <button class="export-btn" bindtap="exportData" data-type="users">å¯¼å‡ºç”¨æˆ·</button>
        <button class="export-btn" bindtap="exportData" data-type="works">å¯¼å‡ºä½œå“</button>
        <button class="export-btn" bindtap="exportData" data-type="orders">å¯¼å‡ºè®¢å•</button>
      </view>
    </view>

    <view class="statistics-grid">
      <view class="stat-card">
        <view class="stat-icon">ğŸ‘¥</view>
        <view class="stat-content">
          <text class="stat-number">{{statistics.totalUsers}}</text>
          <text class="stat-label">æ€»ç”¨æˆ·æ•°</text>
        </view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸŸ¢</view>
        <view class="stat-content">
          <text class="stat-number">{{statistics.activeUsers}}</text>
          <text class="stat-label">æ´»è·ƒç”¨æˆ·</text>
        </view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸ¨</view>
        <view class="stat-content">
          <text class="stat-number">{{statistics.totalWorks}}</text>
          <text class="stat-label">æ€»ä½œå“æ•°</text>
        </view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸ“ˆ</view>
        <view class="stat-content">
          <text class="stat-number">{{statistics.todayWorks}}</text>
          <text class="stat-label">ä»Šæ—¥ä½œå“</text>
        </view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸ’°</view>
        <view class="stat-content">
          <text class="stat-number">{{statistics.totalCredits}}</text>
          <text class="stat-label">æ€»ç§¯åˆ†</text>
        </view>
      </view>
      <view class="stat-card">
        <view class="stat-icon">ğŸ†•</view>
        <view class="stat-content">
          <text class="stat-number">{{statistics.todayCredits}}</text>
          <text class="stat-label">ä»Šæ—¥ç§¯åˆ†</text>
        </view>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && isEmpty}}">
    <text class="empty-icon">ğŸ“­</text>
    <text class="empty-text">æš‚æ— æ•°æ®</text>
  </view>
</view>

<!-- AIæ¨¡å‹æ·»åŠ /ç¼–è¾‘å¼¹çª— -->
<view class="modal-overlay" wx:if="{{showModelDialog}}" bindtap="hideModelDialog">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">{{editingModel ? 'ç¼–è¾‘æ¨¡å‹' : 'æ·»åŠ æ¨¡å‹'}}</text>
      <text class="modal-close" bindtap="hideModelDialog">âœ•</text>
    </view>
    <view class="modal-body">
      <view class="form-group">
        <text class="form-label">æ¨¡å‹åç§° <text class="char-count">{{modelForm.name.length}}/50</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥æ¨¡å‹åç§°"
          value="{{modelForm.name}}"
          bindinput="onModelFormInput"
          data-field="name"
          maxlength="50"
        />
      </view>
      <view class="form-group">
        <text class="form-label">æ¨¡å‹æè¿° <text class="char-count">{{modelForm.description.length}}/200</text></text>
        <textarea 
          class="form-textarea" 
          placeholder="è¯·è¾“å…¥æ¨¡å‹æè¿°"
          value="{{modelForm.description}}"
          bindinput="onModelFormInput"
          data-field="description"
          maxlength="200"
        />
      </view>
      <view class="form-group">
        <text class="form-label">æ¨¡å‹ç±»å‹</text>
        <picker 
          bindchange="onModelTypeChange" 
          value="{{modelTypeIndex}}" 
          range="{{modelTypes}}"
        >
          <view class="picker-display">
            {{modelTypes[modelTypeIndex] || 'è¯·é€‰æ‹©æ¨¡å‹ç±»å‹'}}
          </view>
        </picker>
      </view>
      <view class="form-group">
        <text class="form-label">APIåœ°å€ <text class="char-count">{{modelForm.apiUrl.length}}/200</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥APIåœ°å€"
          value="{{modelForm.apiUrl}}"
          bindinput="onModelFormInput"
          data-field="apiUrl"
          maxlength="200"
        />
      </view>
      <view class="form-group">
        <text class="form-label">APIå¯†é’¥ <text class="char-count">{{modelForm.apiKey.length}}/100</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥APIå¯†é’¥"
          value="{{modelForm.apiKey}}"
          bindinput="onModelFormInput"
          data-field="apiKey"
          password="{{!showApiKey}}"
          maxlength="100"
        />
        <text class="show-password" bindtap="toggleApiKeyVisibility">
          {{showApiKey ? 'ğŸ‘ï¸' : 'ğŸ‘ï¸â€ğŸ—¨ï¸'}}
        </text>
      </view>
      <view class="form-group">
        <text class="form-label">æƒé‡ (1-100)</text>
        <slider 
          value="{{modelForm.weight}}" 
          min="1" 
          max="100" 
          bindchange="onModelWeightChange"
          show-value
        />
      </view>
      <view class="form-group">
        <text class="form-label">ä¼˜å…ˆçº§ (1-10)</text>
        <slider 
          value="{{modelForm.priority}}" 
          min="1" 
          max="10" 
          bindchange="onModelPriorityChange"
          show-value
        />
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="hideModelDialog">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="saveModel">ä¿å­˜</button>
    </view>
  </view>
</view>

<!-- æç¤ºè¯æ·»åŠ /ç¼–è¾‘å¼¹çª— -->
<view class="modal-overlay" wx:if="{{showPromptDialog}}" bindtap="hidePromptDialog">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">{{editingPrompt ? 'ç¼–è¾‘æç¤ºè¯' : 'æ·»åŠ æç¤ºè¯'}}</text>
      <text class="modal-close" bindtap="hidePromptDialog">âœ•</text>
    </view>
    <view class="modal-body">
      <view class="form-group">
        <text class="form-label">æ¨¡æ¿åç§° <text class="char-count">{{promptForm.name.length}}/50</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥æ¨¡æ¿åç§°"
          value="{{promptForm.name}}"
          bindinput="onPromptFormInput"
          data-field="name"
          maxlength="50"
        />
      </view>
      <view class="form-group">
        <text class="form-label">æ¨¡æ¿æè¿° <text class="char-count">{{promptForm.description.length}}/200</text></text>
        <textarea 
          class="form-textarea" 
          placeholder="è¯·è¾“å…¥æ¨¡æ¿æè¿°"
          value="{{promptForm.description}}"
          bindinput="onPromptFormInput"
          data-field="description"
          maxlength="200"
        />
      </view>
      <view class="form-group">
        <text class="form-label">åˆ†ç±» <text class="char-count">{{promptForm.category.length}}/30</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥åˆ†ç±»ï¼ˆphotography/fittingï¼‰"
          value="{{promptForm.category}}"
          bindinput="onPromptFormInput"
          data-field="category"
          maxlength="30"
        />
        <view class="category-tips">
          <text class="tips-small">å¸¸ç”¨åˆ†ç±»ï¼šphotographyï¼ˆæ‘„å½±ï¼‰ã€fittingï¼ˆè¯•è¡£ï¼‰</text>
        </view>
      </view>
      <view class="form-group">
        <text class="form-label">æç¤ºè¯æ¨¡æ¿ <text class="char-count">{{promptForm.template.length}}/2000</text></text>
        <textarea 
          class="form-textarea extra-large" 
          placeholder="è¯·è¾“å…¥æç¤ºè¯æ¨¡æ¿ï¼Œä½¿ç”¨ {å˜é‡å} æ ¼å¼å®šä¹‰å˜é‡ã€‚å»ºè®®ä½¿ç”¨ç®€æ´ã€é«˜æ•ˆçš„æ¨¡æ¿ã€‚"
          value="{{promptForm.template}}"
          bindinput="onPromptFormInput"
          data-field="template"
          maxlength="2000"
        />
        <view class="template-tips">
          <text class="tips-title">ğŸ’¡ æ¨¡æ¿ä¼˜åŒ–å»ºè®®ï¼š</text>
          <text class="tips-item">â€¢ ä½¿ç”¨ç®€æ´çš„æè¿°è¯­è¨€</text>
          <text class="tips-item">â€¢ é‡ç‚¹çªå‡ºæ ¸å¿ƒè¦æ±‚</text>
          <text class="tips-item">â€¢ åˆç†ä½¿ç”¨å˜é‡ {å˜é‡å}</text>
        </view>
      </view>
      <view class="form-group">
        <text class="form-label">å˜é‡åˆ—è¡¨ <text class="char-count">{{promptForm.variablesText.length}}/300</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥å˜é‡åï¼Œå¤šä¸ªå˜é‡ç”¨é€—å·åˆ†éš”ï¼ˆå¦‚ï¼šgender,age,clothingï¼‰"
          value="{{promptForm.variablesText}}"
          bindinput="onPromptFormInput"
          data-field="variablesText"
          maxlength="300"
        />
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="hidePromptDialog">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="savePrompt">ä¿å­˜</button>
    </view>
  </view>
</view>

<!-- åœºæ™¯æ·»åŠ /ç¼–è¾‘å¼¹çª— -->
<view class="modal-overlay" wx:if="{{showSceneDialog}}" bindtap="hideSceneDialog">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">{{editingScene ? 'ç¼–è¾‘åœºæ™¯' : 'æ·»åŠ åœºæ™¯'}}</text>
      <text class="modal-close" bindtap="hideSceneDialog">âœ•</text>
    </view>
    <view class="modal-body">
      <view class="form-group">
        <text class="form-label">åœºæ™¯åç§° <text class="char-count">{{sceneForm.name.length}}/50</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥åœºæ™¯åç§°"
          value="{{sceneForm.name}}"
          bindinput="onSceneFormInput"
          data-field="name"
          maxlength="50"
        />
      </view>
      <view class="form-group">
        <text class="form-label">åœºæ™¯æè¿° <text class="char-count">{{sceneForm.description.length}}/200</text></text>
        <textarea 
          class="form-textarea" 
          placeholder="è¯·è¾“å…¥åœºæ™¯æè¿°"
          value="{{sceneForm.description}}"
          bindinput="onSceneFormInput"
          data-field="description"
          maxlength="200"
        />
      </view>
      <view class="form-group">
        <text class="form-label">åœºæ™¯åˆ†ç±» <text class="char-count">{{sceneForm.category.length}}/30</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥åœºæ™¯åˆ†ç±»"
          value="{{sceneForm.category}}"
          bindinput="onSceneFormInput"
          data-field="category"
          maxlength="30"
        />
      </view>
      <view class="form-group">
        <text class="form-label">åœºæ™¯æ ‡ç­¾ <text class="char-count">{{sceneForm.tagsText.length}}/100</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥æ ‡ç­¾ï¼Œå¤šä¸ªæ ‡ç­¾ç”¨é€—å·åˆ†éš”"
          value="{{sceneForm.tagsText}}"
          bindinput="onSceneFormInput"
          data-field="tagsText"
          maxlength="100"
        />
      </view>
      <view class="form-group">
        <text class="form-label">åœºæ™¯å›¾æ ‡ <text class="char-count">{{sceneForm.icon.length}}/50</text></text>
        <input 
          class="form-input" 
          placeholder="è¯·è¾“å…¥åœºæ™¯å›¾æ ‡ï¼ˆemojiæˆ–å›¾ç‰‡è·¯å¾„ï¼‰"
          value="{{sceneForm.icon}}"
          bindinput="onSceneFormInput"
          data-field="icon"
          maxlength="50"
        />
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="hideSceneDialog">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="saveScene">ä¿å­˜</button>
    </view>
  </view>
</view>

<!-- å¥—é¤æ·»åŠ /ç¼–è¾‘å¼¹çª— -->
<view class="modal-overlay" wx:if="{{showPackageDialog}}" bindtap="hidePackageDialog">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">{{editingPackage ? 'ç¼–è¾‘å¥—é¤' : 'æ·»åŠ å¥—é¤'}}</text>
      <text class="modal-close" bindtap="hidePackageDialog">âœ•</text>
    </view>
    <view class="modal-body">
      <view class="form-group">
        <text class="form-label">å¥—é¤åç§° <text class="char-count">{{packageForm.name.length}}/30</text></text>
        <input
          class="form-input"
          placeholder="è¯·è¾“å…¥å¥—é¤åç§°"
          value="{{packageForm.name}}"
          bindinput="onPackageFormInput"
          data-field="name"
          maxlength="30"
        />
      </view>
      <view class="form-group">
        <text class="form-label">å¥—é¤æè¿° <text class="char-count">{{packageForm.description.length}}/100</text></text>
        <textarea
          class="form-textarea"
          placeholder="è¯·è¾“å…¥å¥—é¤æè¿°"
          value="{{packageForm.description}}"
          bindinput="onPackageFormInput"
          data-field="description"
          maxlength="100"
        />
      </view>
      <view class="form-row">
        <view class="form-group half">
          <text class="form-label">ç§¯åˆ†æ•°é‡</text>
          <input
            class="form-input"
            placeholder="25"
            type="number"
            value="{{packageForm.credits}}"
            bindinput="onPackageFormInput"
            data-field="credits"
          />
        </view>
        <view class="form-group half">
          <text class="form-label">å”®ä»· (å…ƒ)</text>
          <input
            class="form-input"
            placeholder="9.9"
            type="digit"
            value="{{packageForm.price}}"
            bindinput="onPackageFormInput"
            data-field="price"
          />
        </view>
      </view>
      <view class="form-row">
        <view class="form-group half">
          <text class="form-label">åŸä»· (å…ƒ)</text>
          <input
            class="form-input"
            placeholder="12.5"
            type="digit"
            value="{{packageForm.originalPrice}}"
            bindinput="onPackageFormInput"
            data-field="originalPrice"
          />
        </view>
        <view class="form-group half">
          <text class="form-label">æ’åº</text>
          <input
            class="form-input"
            placeholder="1"
            type="number"
            value="{{packageForm.sortOrder}}"
            bindinput="onPackageFormInput"
            data-field="sortOrder"
          />
        </view>
      </view>
      <view class="form-group">
        <text class="form-label">ä¼˜æƒ æ ‡ç­¾ <text class="char-count">{{packageForm.discount.length}}/20</text></text>
        <input
          class="form-input"
          placeholder="ä¾‹å¦‚ï¼šé™æ—¶8æŠ˜ã€è¶…å€¼ä¼˜æƒ "
          value="{{packageForm.discount}}"
          bindinput="onPackageFormInput"
          data-field="discount"
          maxlength="20"
        />
      </view>
      <view class="form-group">
        <view class="switch-row">
          <text class="switch-label">è®¾ä¸ºçƒ­é—¨å¥—é¤</text>
          <switch
            checked="{{packageForm.isPopular}}"
            bindchange="onPackageToggle"
            data-field="isPopular"
          />
        </view>
      </view>
      <view class="form-group">
        <view class="switch-row">
          <text class="switch-label">å¯ç”¨å¥—é¤</text>
          <switch
            checked="{{packageForm.isActive}}"
            bindchange="onPackageToggle"
            data-field="isActive"
          />
        </view>
      </view>
    </view>
    <view class="modal-footer">
      <button class="btn-cancel" bindtap="hidePackageDialog">å–æ¶ˆ</button>
      <button class="btn-confirm" bindtap="savePackage">ä¿å­˜</button>
    </view>
  </view>
</view>